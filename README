################################################################################
# Prerequisites: (debian lenny)
    apt-get install -y dh-make-perl                                            \
                       libcatalyst-perl libcatalyst-modules-perl               \
                       libcatalyst-modules-extra-perl                          \
                       libnet-ldap-perl libnet-ldap-server-perl                \
                       libconvert-asn1-perl
# Catalyst-Plugin-Authentication-Store-LDAP (I used 0.1005)
    bin/cpan2deb http://search.cpan.org/CPAN/authors/id/K/KA/KARMAN/Catalyst-Authentication-Store-LDAP-0.1005.tar.gz
    dpkg -i /opt/local/src/CPAN/libcatalyst-authentication-store-ldap-perl_0.1005-1_all.deb
    bin/cpan2deb http://search.cpan.org/CPAN/authors/id/A/AG/AGRUNDMA/Catalyst-Plugin-RequireSSL-0.06.tar.gz
    dpkg -i /opt/local/src/CPAN/libcatalyst-plugin-requiressl-perl_0.06-1_all.deb
# Run script/pkild_server.pl to test the application.


################################################################################
# Adding to Apache
# You'll need to install the ssl server too as this application forces SSL
################################################################################
apt-get install -y apache2-mpm-prefork libapache2-mod-perl2                  \
                   libcatalyst-engine-apache-perl perlmagick                 \
                   libcatalyst-modules-extra-perl libcatalyst-modules-perl   \
                   libcatalyst-perl libcatalyst-plugin-session-fastmmap-perl \
                   libcatalyst-view-tt-perl libhtml-prototype-perl

[ -d /var/cache/git ] || mkdir -p /var/cache/git
(cd /var/cache/git; git clone git://github.com/fapestniegd/pkild.git )

# httpd.conf
# (Outside of VirtualHost block (main section))
PerlSwitches -I/var/cache/git/pkild/lib
PerlModule pkild

#<VirtualHost..>
<Location />
    SetHandler          modperl
    PerlResponseHandler pkild
</Location>
#</VirtualHost..>

# That's it.

################################################################################
# Thoughts
################################################################################
Create:
  Root Certificate Authority
    Intermediate Certificate Authority
      host_certificate
    Intermediate Certificate Authority
    
